---
title: "Multiple PK summary tables together"
date: "Compiled on `r format(Sys.time(), '%B %d, %Y')`"
output: word_document
---

```{r setupPKSummaryOutput, echo=FALSE}

knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, 
                      dpi = 600, 
                      fig.width = 6, 
                      fig.height = 5)

```

```{r FigtextPKSummary}

Observedincluded <- any(str_detect(MyPKResults$Statistic, "S/O"))
MeanType <- ifelse(is.na(mean_type), "geometric", mean_type)

```

*Table XXX. Simulated`r ifelse(Observedincluded, " and observed", "")` `r MeanType` mean PK parameters.*

```{r makeTablePKSummaryOutput}

if("File" %in% names(MyPKResults)){
    MyPKResults <- MyPKResults %>% 
        select(!matches("File"), File)
}

formatTable_Simcyp(MyPKResults)

```

```{r captionPKSummary}

CapText1a <- paste0(ifelse(any(str_detect(names(MyPKResults), "tmax")), 
                              "t~max~: median, min, max; ", ""), 
                       ifelse(any(str_detect(MyPKResults$Statistic, "CV")),
                              "CV: Coefficient of Variation; ", ""), 
                       ifelse(any(str_detect(MyPKResults$Statistic, " CI")),
                              "CI: Confidence Interval; ", ""))

CapText1 <- paste0(sub("; $", ".", CapText1a), 
                   ifelse(Observedincluded, 
                          "S/O: Simulated/Observed; Source observed data: Clinical Study XXX; ",
                          ""))
    
CapText2 <- str_comma(sim_data_files)

```

*Simulated values listed are the `r MeanType` means. `r CapText1` Source simulated data: `r CapText2`* 


