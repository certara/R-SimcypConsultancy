---
title: "PK summary table"
date: "Compiled on `r format(Sys.time(), '%B %d, %Y')`"
output: word_document
---

```{r setupPKSummaryOutput, echo=FALSE}

knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, 
                      dpi = 600, 
                      fig.width = 6, 
                      fig.height = 5)

```

```{r flextablePKSummaryOutput}

flextable_simcyp <- function(DF){
    
    DF %>% flextable::flextable() %>% 
        flextable::bold(part = "header") %>%
        flextable::bold(j = 1, part = "body") %>% 
        flextable::align(align = "center", part = "header") %>%
        flextable::border_remove() %>% 
        flextable::border_inner_v(part = "all", 
                                  border = officer::fp_border(width = 0.5)) %>% 
        flextable::border_outer(border = officer::fp_border(width = 0.5)) %>% 
        flextable::set_table_properties(width = 1, layout = "autofit")
    
}

```

```{r makeTablePKSummaryOutput}

if("File" %in% names(MyPKResults)){
    MyPKResults <- MyPKResults %>% 
        select(!matches("File"), File)
}

flextable_simcyp(MyPKResults)

```

*t~max~: median, min, max; CI: Confidence Interval; CV: Coefficient of Variation; S/O: Simulated/Observed; Source observed data: Clinical Study \*\*; Source simulated data: `r str_comma(unique(sim_data_files))`* 


