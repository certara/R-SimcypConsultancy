---
title: "Concentration-time plots with experimental details"
date: "Compiled on `r format(Sys.time(), '%B %d, %Y')`"
output: word_document
---

```{r setupctplot, echo=FALSE}

knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, 
                      dpi = 600)

```


```{r ctplotdetails}

Deets <- extractExpDetails(sim_data_file = 
                               paste0(CurrentDir, "/", unique(ct_dataframe$File)))

InhibPresent <- length(MyEffector) > 0 && complete.cases(MyEffector)
MySubstrate <- Deets$Substrate
MyTissue <- unique(ct_dataframe$Tissue)
NumSubjtext <- paste(Deets$NumTrials, "trials of", Deets$NumSubjTrial, 
                     "subjects each")

FigText1 <- switch(linear_or_log, 
                   "semi-log" = "",
                   "linear" = "", 
                   "both" = ifelse(graph_labels, 
                                   "Linear (A) and log-linear (B)",
                                   "Linear (top) and log-linear (bottom)"), 
                   "both vertical" = ifelse(graph_labels, 
                                            "Linear (A) and log-linear (B)",
                                            "Linear (top) and log-linear (bottom)"), 
                   "both horizontal" = ifelse(graph_labels, 
                                              "Linear (A) and log-linear (B)",
                                              "Linear (left) and log-linear (right)"))

FigText2 <- ifelse(nrow(ct_dataframe %>% filter(Simulated == FALSE)) > 0, 
                   "and observed ", "")

FigText3 <- ifelse(Deets$DoseRoute_sub == "Oral", 
                   switch(Deets$Regimen_sub, 
                          "Single Dose" = "a single oral dose", 
                          "Multiple Dose" = "multiple oral doses"), 
                   switch(Deets$Regimen_sub, 
                          "Single Dose" = paste("a single", Deets$DoseRoute_sub,
                                                "dose"),
                          "Multiple Dose" = paste("multiple", Deets$DoseRoute_sub,
                                                  "doses")))


```

Figure XXX. `r FigText1` simulated `r FigText2``r mean_type` mean `r MyTissue` concentration-time profiles of `r FigText3` of `r paste(Deets$Dose_sub, "mg", Deets$Substrate)` in `r tidyPop(Deets$Population)$PopulationSimpleLower`.


```{r ctplot, fig.width = fig_width, fig.height = fig_height}
Out

```


```{r ctplotCaption}

CapText1 <-
    switch(as.character(
        InhibPresent), 
        "FALSE" = ifelse(nrow(ct_dataframe %>% filter(Simulated == FALSE)) > 0,
                         paste0("simulated (lines) and observed data (circles;", 
                                mean_type, " mean of n = XXX individuals; Clinical Study XXX)"), 
                         "simulated data (lines)"), 
        
        "TRUE" = paste(
            ifelse(nrow(ct_dataframe %>% filter(Simulated == FALSE)) > 0,
                   paste("and observed (circles;", mean_type, 
                         "mean of n = XXX individuals; Clinical Study XXX)"), 
                   ""), 
            MyTissue, "concentration-time profiles of", MySubstrate, 
            "following", FigText3, "of", MySubstrate, 
            "in the absence of", MyEffector, 
            " (solid line) and on the XXXth day of XXX days of dosing of", 
            MyEffector, "(dashed line)"))

CapText2 <- switch(
    figure_type, 
    "trial means" = 
        paste0("The grey lines represent ",
               mean_type, 
               " mean values of simulated individual trials and the black lines portray the ",
               mean_type, 
               " mean data of the simulated population (n = ", NumSubjtext, ")"), 
    "percentiles" = 
        paste0("The grey lines represent the 5th and 95th percentiles and the solid black line the ",
               mean_type, 
               " mean data of the simulated population (n = ", NumSubjtext, ")"), 
    "percentile ribbon" = 
        paste0("The shaded regions represent the 5th to the 95th percentiles and the solid black line the ",
               mean_type,
               " mean data of the simulated population (n = ", NumSubjtext, ")"), 
    "means only" = 
        paste0("The solid black line represents the ", 
               mean_type, 
               " mean data of the simulated population (n = ", NumSubjtext, ")"), 
    "Freddy" = 
        paste0("The grey lines represent ", 
               mean_type, 
               " mean values of simulated individual trials and the black lines portray the ",
               mean_type, 
               "mean data of the simulated population (n = ", NumSubjtext, 
               "). The dashed lines represent the 5th and 95th percentiles"))

```

*Depicted are `r CapText1`. `r CapText2`. Source simulated data: `r unique(ct_dataframe$File)`.*


